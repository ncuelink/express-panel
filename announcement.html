<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ ¡åœ’å…¬å‘Š | å½°å¸«é€š NcueLink</title>
  <link rel="icon" type="image/x-icon" href="img/favicon.ico">
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <!-- <header class="navbar">
    <h1>
      <a href="https://sites.google.com/view/ncuelink/"><img src="img/favicon.ico" alt="å½°å¸«é€š" width="25" height="25"> å½°å¸«é€š NcueLink</a>
      <span style="font-size:small;"><i>Express Panel æ¸¬è©¦ç‰ˆ</i></span>
    </h1>
    <nav>
      <ul class="nav-links">
        <li><a href="https://sites.google.com/view/ncuelink/">é¦–é </a></li>
        <li><a href="https://aps.ncue.edu.tw/ncueact/index.php" target="_blank">è¡Œå‹•å½°å¸«</a></li>
        <li><a href="https://apkpure.com/tw/p/developer.angus.ncuelink" target="_blank">APP</a></li>
      </ul>
    </nav>
  </header> -->

  <main class="main-content">
    <section class="notifications">
      <!-- <h2>é€šçŸ¥</h2> -->
      <div class="notification info">âœ¨ æ­¡è¿ä½¿ç”¨ å½°å¸«é€š NcueLink ~~~</div>
      <div class="notification warning">ğŸš§ è¡Œå‹•å½°å¸«ç„¡æ³•ç™»å…¥<a href="https://www.dcard.tw/f/ncue/p/240250433?cid=b27434e1-7452-4189-b731-bdf20ee0314a" target="_blank">è§£æ±ºæ–¹å¼</a>ï¼š
        <span style="font-weight: normal;"><br><br> - æ–¹æ³• 1ï¼šã€Œé•·æŒ‰ã€è¡Œå‹•å½°å¸«å³ä¸Šç™»å…¥æŒ‰éˆ•ï¼Œå³å¯æ­£å¸¸ç™»å…¥ï¼<br> - æ–¹æ³• 2ï¼šåŠŸèƒ½è¡¨ > è¨­å®š > é–‹å•Ÿã€Œæ”¹ç”¨å­¸æ ¡ç¶²é ç‰ˆè¡Œå‹•å½°å¸«ã€</div></span></div>
    </section>
    
    <section class="campus-news">
      <h2>ğŸ“¢ æ ¡åœ’å…¬å‘Š</h2>
      <ul id="rss-feed" class="card-list">
        <li>Loading...</li>
      </ul>
    </section>

    <section class="campus-news">
      <h2>ğŸ² æ´»å‹•å ±å</h2>
      <ul id="campaign-feed" class="card-list">
        <li>Loading...</li>
      </ul>
    </section>
  </main>

  <!-- <footer class="footer">
    <p>Â© 2021-2025&ensp;å½°å¸«é€š NcueLink.&ensp;All Rights Reserved.</p>
  </footer> -->

  <script>
    function loadData(data) {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = ""; // Clear the loading message

      data.forEach(item => {
        const listItem = document.createElement("li");
        listItem.className = "card";

        const date = document.createElement("div");
        date.className = "date";
        date.textContent = item.Date;

        const content = document.createElement("div");
        content.className = "content";

        const anchor = document.createElement("a");
        anchor.href = item.URL;
        anchor.target = "_blank";
        anchor.textContent = item.Content;

        content.appendChild(anchor);
        listItem.appendChild(date);
        listItem.appendChild(content);
        rssFeed.appendChild(listItem);
      });
    }

    // Google App Script ç¶²é æ‡‰ç”¨ç¨‹å¼ URL
    var url = "https://script.google.com/macros/s/AKfycbx09VvhU52vKsGgVYUt9vHGrVG9h5EBFeCuXhEOzBrmMB1N4xquVVP1R4JJZP45dbSY/exec"+"?callback=loadData";

    jQuery.ajax({
      crossDomain: true,
      url: url,
      method: "GET",
      dataType: "jsonp"
    });
  </script>

  <script>
    function loadData(data) {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = ""; // Clear the loading message

      data.forEach(item => {
        const listItem = document.createElement("li");
        listItem.className = "card";

        const date = document.createElement("div");
        date.className = "date";
        date.textContent = item.Date;

        const content = document.createElement("div");
        content.className = "content";

        const anchor = document.createElement("a");
        anchor.href = item.URL;
        anchor.target = "_blank";
        anchor.textContent = item.Content;

        content.appendChild(anchor);
        listItem.appendChild(date);
        listItem.appendChild(content);
        rssFeed.appendChild(listItem);
      });
    }

    // Google App Script ç¶²é æ‡‰ç”¨ç¨‹å¼ URL
    var url = "https://script.google.com/macros/s/AKfycbx09VvhU52vKsGgVYUt9vHGrVG9h5EBFeCuXhEOzBrmMB1N4xquVVP1R4JJZP45dbSY/exec"+"?callback=loadData";

    jQuery.ajax({
      crossDomain: true,
      url: url,
      method: "GET",
      dataType: "jsonp"
    });
  </script>

  <script>
    function loadData2(data) {
      const rssFeed = document.getElementById('campaign-feed');
      rssFeed.innerHTML = ""; // Clear the loading message

      data.forEach(item => {
        const listItem = document.createElement("li");
        listItem.className = "card";

        const date = document.createElement("div");
        date.className = "date";
        date.textContent = item.æ´»å‹•æ—¥æœŸ;

        const content = document.createElement("div");
        content.className = "content";

        const anchor = document.createElement("a");
        anchor.href = item.URL;
        anchor.target = "_blank";
        anchor.textContent = item.æ´»å‹•åç¨±;

        const status = document.createElement("div");
        status.className = "date";
        status.textContent = item.ç‹€æ…‹;

        content.appendChild(anchor);
        listItem.appendChild(date);
        listItem.appendChild(status);
        listItem.appendChild(content);
        
        rssFeed.appendChild(listItem);
      });
    }

    // Google App Script ç¶²é æ‡‰ç”¨ç¨‹å¼ URL
    var url = "https://script.google.com/macros/s/AKfycbwRMFQ8PqBcXgwM_WPlB9bAH0nVBc_26Y_Lu6X8sOny/dev"+"?callback=loadData2";

    jQuery.ajax({
      crossDomain: true,
      url: url,
      method: "GET",
      dataType: "jsonp"
    });
  </script>
</body>
</html>
