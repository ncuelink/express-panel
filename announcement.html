<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ ¡åœ’å…¬å‘Š | å½°å¸«é€š NcueLink</title>
  <link rel="icon" type="image/x-icon" href="img/favicon.ico">
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <!-- <header class="navbar">
    <h1>
      <a href="https://sites.google.com/view/ncuelink/"><img src="img/favicon.ico" alt="å½°å¸«é€š" width="25" height="25"> å½°å¸«é€š NcueLink</a>
      <span style="font-size:small;"><i>Express Panel æ¸¬è©¦ç‰ˆ</i></span>
    </h1>
    <nav>
      <ul class="nav-links">
        <li><a href="https://sites.google.com/view/ncuelink/">é¦–é </a></li>
        <li><a href="https://aps.ncue.edu.tw/ncueact/index.php" target="_blank">è¡Œå‹•å½°å¸«</a></li>
        <li><a href="https://apkpure.com/tw/p/developer.angus.ncuelink" target="_blank">APP</a></li>
      </ul>
    </nav>
  </header> -->

  <main class="main-content">
    <section class="notifications">
      <!-- <h2>é€šçŸ¥</h2> -->
      <div class="notification info">âœ¨ æ­¡è¿ä½¿ç”¨ å½°å¸«é€š NcueLink ~~~</div>
      <div class="notification warning">ğŸš§ è¡Œå‹•å½°å¸«ç„¡æ³•ç™»å…¥<a href="https://www.dcard.tw/f/ncue/p/240250433?cid=b27434e1-7452-4189-b731-bdf20ee0314a" target="_blank">è§£æ±ºæ–¹å¼</a>ï¼š
        <span style="font-weight: normal;"><br><br> - æ–¹æ³• 1ï¼šã€Œé•·æŒ‰ã€è¡Œå‹•å½°å¸«å³ä¸Šç™»å…¥æŒ‰éˆ•ï¼Œå³å¯æ­£å¸¸ç™»å…¥ï¼<br> - æ–¹æ³• 2ï¼šåŠŸèƒ½è¡¨ > è¨­å®š > é–‹å•Ÿã€Œæ”¹ç”¨å­¸æ ¡ç¶²é ç‰ˆè¡Œå‹•å½°å¸«ã€</div></span></div>
    </section>
    
    <section class="campus-news">
      <!-- <h2>ğŸ“¢ æ ¡åœ’å…¬å‘Šï¼æ´»å‹•å ±å</h2> -->
      <div class="news-tab-container">
        <button class="news-tab active" onclick="loadCampusNews()">æ ¡åœ’å…¬å‘Š</button>
        <button class="news-tab" onclick="loadAllActivities()">æ‰€æœ‰æ´»å‹•</button>
        <button class="news-tab" onclick="loadGeneralLectures()">é€šè­˜è¬›åº§</button>
      </div>
      <ul id="rss-feed" class="card-list">
        <li>Loading...</li>
      </ul>
    </section>

    <section class="notifications">
      <!-- <h2>é€šçŸ¥</h2> -->
      <div class="notification warning" style="font-weight: normal;">
        ğŸ”” å°æé†’ï¼šä»¥ä¸Šè³‡è¨Šç‹€æ…‹æœ‰å¯èƒ½ä¸æ˜¯æœ€å³æ™‚çš„æ›´æ–°ï¼Œæ­£ç¢ºè³‡è¨Šé‚„æ˜¯ä»¥<a href="https://aps.ncue.edu.tw/sign_up/index.php" target="_blank">å­¸æ ¡ç¶²ç«™</a>ç‚ºä¸»å–”ï¼
      </div>
    </section>

  </main>

  <!-- <footer class="footer">
    <p>Â© 2021-2025&ensp;å½°å¸«é€š NcueLink.&ensp;All Rights Reserved.</p>
  </footer> -->

  <script>
    function updateActiveTab(selectedButton) {
      document.querySelectorAll('.news-tab').forEach(button => {
        button.classList.remove('active');
      });
      selectedButton.classList.add('active');
    }

    function loadRSSFeed(url) {
      jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
    }

    function loadData1(data) {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = ""; // æ¸…é™¤ç¾æœ‰å…§å®¹

      data.forEach(item => {
        const listItem = document.createElement("li");
        listItem.className = "card";

        const date = document.createElement("div");
        date.className = "date";
        date.textContent = item.Date;

        const content = document.createElement("div");
        content.className = "content";

        const anchor = document.createElement("a");
        anchor.href = item.URL;
        anchor.target = "_blank";
        anchor.textContent = item.Content;

        content.appendChild(anchor);
        listItem.appendChild(date);
        listItem.appendChild(content);
        rssFeed.appendChild(listItem);
      });
    }

    function loadData2(data) {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = ""; // Clear the loading message

      data.forEach(item => {
        const listItem = document.createElement("li");
        listItem.className = "card";

        const date = document.createElement("div");
        date.className = "date";
        date.textContent = item.æ´»å‹•æ—¥æœŸ;

        const content = document.createElement("div");
        content.className = "content";

        const anchor = document.createElement("a");
        anchor.href = item.URL;
        anchor.target = "_blank";
        anchor.textContent = item.æ´»å‹•åç¨±;

        const status = document.createElement("div");
        status.className = "date";
        status.textContent = item.ç‹€æ…‹;

        content.appendChild(anchor);
        listItem.appendChild(status);
        listItem.appendChild(content);
        listItem.appendChild(date);

        rssFeed.appendChild(listItem);
      });
    }

    function loadCampusNews() {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = "<li>Loading...</li>"; // Clear the loading message
      updateActiveTab(document.querySelector('.news-tab:nth-child(1)'));
      loadRSSFeed("https://script.google.com/macros/s/AKfycbx09VvhU52vKsGgVYUt9vHGrVG9h5EBFeCuXhEOzBrmMB1N4xquVVP1R4JJZP45dbSY/exec?callback=loadData1");
    }

    function loadAllActivities() {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = "<li>Loading...</li>"; // Clear the loading message
      updateActiveTab(document.querySelector('.news-tab:nth-child(2)'));
      loadRSSFeed("https://script.google.com/macros/s/AKfycbzgP6WUGCnUeAQtePUhcOOx4kjlM69gS60HmqhXijGU9tma1p72N42-5TZh5zsy8c5TCA/exec?callback=loadData2&mode=æ‰€æœ‰æ´»å‹•"); // æ›¿æ›ç‚ºæ‰€æœ‰æ´»å‹•çš„ JSONP ä¾†æº
    }

    function loadGeneralLectures() {
      const rssFeed = document.getElementById('rss-feed');
      rssFeed.innerHTML = "<li>Loading...</li>"; // Clear the loading message
      updateActiveTab(document.querySelector('.news-tab:nth-child(3)'));
      loadRSSFeed("https://script.google.com/macros/s/AKfycbzgP6WUGCnUeAQtePUhcOOx4kjlM69gS60HmqhXijGU9tma1p72N42-5TZh5zsy8c5TCA/exec?callback=loadData2&mode=é€šè­˜è¬›åº§"); // æ›¿æ›ç‚ºé€šè­˜è¬›åº§çš„ JSONP ä¾†æº
    }

    loadCampusNews(); // é è¨­è¼‰å…¥æ ¡åœ’å…¬å‘Š
  </script>
</body>
</html>
